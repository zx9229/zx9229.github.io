<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>SSH端口转发 | zx9229.github.io</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="摘要暂略。">
<meta property="og:type" content="article">
<meta property="og:title" content="SSH端口转发">
<meta property="og:url" content="http://zx9229.github.io/2018/07/19/SSH端口转发/index.html">
<meta property="og:site_name" content="zx9229.github.io">
<meta property="og:description" content="摘要暂略。">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2018-07-19T14:54:50.148Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="SSH端口转发">
<meta name="twitter:description" content="摘要暂略。">
  
    <link rel="alternate" href="/atom.xml" title="zx9229.github.io" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">zx9229.github.io</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://zx9229.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-SSH端口转发" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/19/SSH端口转发/" class="article-date">
  <time datetime="2018-07-19T13:05:52.000Z" itemprop="datePublished">2018-07-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Linux/">Linux</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      SSH端口转发
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- Table of Contents -->
        
        <p>摘要暂略。<br><a id="more"></a></p>
<h3 id="EPEL"><a href="#EPEL" class="headerlink" title="EPEL"></a>EPEL</h3><p><a href="https://fedoraproject.org/wiki/EPEL" target="_blank" rel="noopener">EPEL - Fedora Project Wiki</a>。<br>EPEL是专门为RHEL、CentOS等Linux发行版提供额外rpm包的。很多os中没有或比较旧的rpm，在epel仓库中可以找到。<br>安装方式：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install epel-release</span><br></pre></td></tr></table></figure></p>
<h3 id="IUS"><a href="#IUS" class="headerlink" title="IUS"></a>IUS</h3><p><a href="https://ius.io" target="_blank" rel="noopener">IUS</a>。<br><code>IUS is a community project that provides RPM packages for newer versions of select software for Enterprise Linux distributions.</code>。<br>IUS是一个社区项目，为Enterprise Linux发行版的新版精选软件提供RPM包。<br><a href="https://ius.io/GettingStarted/#install-via-automation" target="_blank" rel="noopener">Getting Started - IUS</a>。<br><a href="https://setup.ius.io/" target="_blank" rel="noopener">自动安装脚本</a>。<br>所以，安装ius的步骤就是<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget --output-document=auto_install_ius.sh  https://setup.ius.io/</span><br><span class="line">bash auto_install_ius.sh</span><br></pre></td></tr></table></figure></p>
<h3 id="SSH端口转发"><a href="#SSH端口转发" class="headerlink" title="SSH端口转发"></a>SSH端口转发</h3><p><a href="https://www.ibm.com/developerworks/cn/linux/l-cn-sshforward/index.html" target="_blank" rel="noopener">实战 SSH 端口转发</a>。  </p>
<h4 id="本地端口转发"><a href="#本地端口转发" class="headerlink" title="本地端口转发"></a>本地端口转发</h4><p>命令格式<code>ssh [-L [bind_address:]port:host:hostport] [-p port] [user@]hostname</code>。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MySQLClient(Host1)         |防火|  MySQLServer(Host2:3389)</span><br><span class="line">  SSHClient(Host1)[63389]  | 墙 |    SSHServer(Host2:2222)</span><br></pre></td></tr></table></figure></p>
<p>机房有一台Linux，其IP地址是<code>Host2</code>，其SSHD服务的端口是2222，上面有一个MySQL服务器在监听3389端口。<br>办公室有一台机器，其IP地址是<code>Host1</code>，上面有一个MySQL客户端。我们想用它登录MySQL服务器。<br><code>ssh -L 127.0.0.1:63389:localhost:3389 -p 2222 用户名@Host2</code><br>让<code>SSHClient</code>监听<code>127.0.0.1:63389</code>并转发数据到<code>SSHServer</code>,然后<code>SSHServer</code>转发数据到<code>localhost:3389</code>。<br>然后MySQL客户端连接<code>127.0.0.1:63389</code>即可。</p>
<h4 id="远程端口转发"><a href="#远程端口转发" class="headerlink" title="远程端口转发"></a>远程端口转发</h4><p>命令格式<code>ssh [-R [bind_address:]port:host:hostport] [-p port] [user@]hostname</code>。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ProxyServer(Host1:1080)    |防火|          yum(Host2)</span><br><span class="line">  SSHClient(Host1)         | 墙 |    SSHServer(Host2:2222)[61080]</span><br></pre></td></tr></table></figure></p>
<p>机房有一台Linux，其IP地址是<code>Host2</code>，其SSHD服务的端口是2222。它被禁止访问外网，所以yum无法安装软件。<br>办公室有台Linux，其IP地址是<code>Host1</code>，上面有一个Proxy服务器在监听1080端口。<br><code>ssh -R localhost:61080:127.0.0.1:1080 -p 2222 用户名@Host2</code><br>让<code>SSHServer</code>监听<code>localhost:61080</code>并转发数据到<code>SSHClient</code>,然后<code>SSHClient</code>转发数据到<code>127.0.0.1:1080</code>。<br>然后修改<code>/etc/yum.conf</code>让yum使用代理连接<code>localhost:61080</code>即可。  </p>
<h4 id="动态转发"><a href="#动态转发" class="headerlink" title="动态转发"></a>动态转发</h4><p>命令格式<code>ssh [-D [bind_address:]port] [-p port] [user@]hostname</code>。<br>值得注意的是，此时它是socks代理，不是http代理，所以wget和yum无法使用。  </p>
<h4 id="cow"><a href="#cow" class="headerlink" title="cow"></a>cow</h4><p><a href="https://github.com/cyfdecyf/cow" target="_blank" rel="noopener">cyfdecyf/cow: HTTP proxy written in Go.</a>。<br>简单验证（wget的http代理设置）<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span>  http_proxy=http://127.0.0.1:61080</span><br><span class="line"><span class="built_in">export</span> https_proxy=https://127.0.0.1:61080</span><br><span class="line">wget http://www.baidu.com/</span><br><span class="line"><span class="built_in">unset</span> http_proxy https_proxy</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://zx9229.github.io/2018/07/19/SSH端口转发/" data-id="cjm3md0x80010tspr0qj85qrg" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/07/23/golang相关的收集贴/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          golang相关的收集贴
        
      </div>
    </a>
  
  
    <a href="/2018/07/13/Python相关收集/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Python相关收集</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Go/">Go</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hexo/">Hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/Python/">Python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/shell/">shell</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/MyDefaultCategory/">MyDefaultCategory</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Windows/">Windows</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Windows/powershell/">powershell</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/golang/">golang</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/python/Ansible/">Ansible</a></li></ul></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/09/12/VC构建命令和属性的宏-Macros-for-Build-Commands-and-Properties/">VC构建命令和属性的宏-Macros-for-Build-Commands-and-Properties</a>
          </li>
        
          <li>
            <a href="/2018/08/25/InternetDownloadManager相关/">InternetDownloadManager相关</a>
          </li>
        
          <li>
            <a href="/2018/08/22/Windows的netsh-interface-portproxy的一个例子/">Windows的netsh-interface-portproxy的一个例子</a>
          </li>
        
          <li>
            <a href="/2018/08/17/OpenTSDB试玩环境搭建步骤/">OpenTSDB试玩环境搭建步骤</a>
          </li>
        
          <li>
            <a href="/2018/08/06/golang的protobuf例子/">golang的protobuf例子</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 zx9229<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>